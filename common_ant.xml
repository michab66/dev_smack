<?xml version='1.0' encoding='UTF-8'?>

<!-- $Id: common_ant.xml 674 2013-06-05 20:49:41Z Michael $ -->

<!-- Place comments and descriptions into the description attributes that are
     available with most of the tags.  This makes this information available
     to tools and scripts.
  -->

<project name="common_ant" basedir=".">

  <!-- Exclude the ant libraries from all javac invocations.
       This will result in a warning. -->
  <presetdef name="javac">
    <javac includeantruntime="false" />
  </presetdef>

  <dirname property="common_ant.basedir" file="${ant.file.common_ant}"/>

  <!-- Common libraries for all projects. -->
  <property
    description="Java Help library"
    name="common_lib.java_help"
    value="${common_ant.basedir}/lib/jhall.jar" />

  <!-- No path prefix since used in filset. -->
  <property
    description="Swing X"
    name="common_lib.swingx"
    value="swingx-all-1.6.5-1.jar" />

  <!-- Common properties for all projects. -->
  <property 
    description="The sourcecode position." 
    name="in.src" 
    value="${basedir}/src"/>

  <property 
    description="The documentation position." 
    name="in.doc" 
    value="${basedir}/doc"/>

  <property 
    description="The position of the libraries used for the build." 
    name="in.lib" 
    value="${basedir}/lib"/>

  <property
    description="The name of a directory used for creating the build."
    name="out.bin"
    value="${basedir}/bin/ant"/>

  <property
    description="The name of a directory used for creating the distributables." 
    name="out.dist"
    value="${basedir}/dist"/>

  <property
    description="The name of a directory for the project web site."
    name="out.web"
    value="${basedir}/web"/>
	
  <property
    description="The JDK version required." 
    name="jdkversion"
    value="1.6"/>

  <property
    description="The name of the commons library." 
    name="dev_common"
    value="dev_common.jar"/>


  <!--  Prefix task names with 'common'. -->
  <taskdef
    name="common-one-jar"
    description="Creates a single executable jar holding all libraries."
    classname="com.simontuffs.onejar.ant.OneJarTask"
    classpath="${common_ant.basedir}/tasks/one-jar-ant-task-0.96.jar"
    onerror="report"/>


  <!-- Default targets -->
	
  <target description="Copies resource files into the build area."
          name="resource">
    <echo message="Dummy target resource called."/>
  </target>

  <target description="Creates the core executable jar."
          name="jar" depends="resource">
    <!-- Jar the project main jar directly to the final position. -->
    <jar
      jarfile="${out.dist}/${ant.project.name}.jar"
      basedir="${out.bin}"
      excludes="${in.src}/doc/**">

      <manifest>
        <attribute name="Main-Class" value="${mainclass}"/>
        <attribute name="Built-By" value="${user.name}"/>
        <section name="${ant.project.name}">
            <attribute 
                name="Implementation-Title" 
                value="${ant.project.name}"/>
            <attribute 
                name="Implementation-Version"
                value="$Rev: 674 $ ${DSTAMP} ${TSTAMP}"/>
        </section>
      </manifest>
    </jar>
  </target>

  <!-- Inverse to target 'clean'. -->
  <target description="Set up the needed directory structure."
          name="prepare">
    <tstamp/>
    <mkdir dir="${out.dist}"/>
    <mkdir dir="${out.bin}"/>
    <mkdir dir="${out.web}"/>
  </target>

  <!-- Inverse to target 'prepare'. -->
  <target description="Remove all files and directories generated by a build."
          name="clean">
    <delete dir="${out.dist}"/>
    <delete dir="${out.bin}"/>
    <delete dir="${out.web}"/>
  </target>

</project>
